# 함수형 프로그래밍이란

- 범용 프로그래밍 패러다임으로 어디에 적합한지 콕 집어 말하기 어렵다.
- 넓은 분야에서 쓰이고 있는 개념이며, 학계나 산업 현장에서도 쓰고 있다.
- 하지만 많은 자료들이 학계에서 만든 자료이기 때문에 일반 개발자 입장에서는 이해하기 어렵고 실용적이지 않다.

## 정의

1. **수학 함수**를 사용하고 **부수 효과**(side effect)를 피하는 것이 특징인 프로그래밍 패러다임
2. **부수 효과**없이 **순수 함수**만 사용하는 프로그래밍 스타일

### 부수 효과

- 함수가 리턴값 이외에 하는 모든 일을 말한다.
- 함수를 부를 때마다 발생하기 때문에 문제가 될 수 있다.
    - 리턴값이 필요해서 함수를 불렀지만 의도하지 않게 부수 효과가 발생할 수 있다.
- 예시) 이메일 보내기, 파일 읽기 등

### 순수 함수

- 인자에만 의존하고 부수 효과가 없는 함수
- 같은 인자를 넣으면 항상 같은 결과를 돌려준다.

```bash
정의에 따르면 함수형 프로그래머는 항상 부수 효과를 피하고 순수 함수만 사용해야 할 것 같지만,
실제 함수형 프로그래머는 부수 효과와 순수하지 않은 함수를 사용한다.
```

## 실용적인 측면에서의 정의의 문제점

### 1. 부수 효과는 필요하다.

- 정의에 따르면 함수형 프로그래밍에서는 부수 효과를 피해야 하지만, 부수 효과는 소프트웨어를 실행하는 이유이다.
    - 이메일을 전송하지 않는 이메일 전송 소프트웨어는 의미가 없다.

### 2. 함수형 프로그래밍은 부수 효과를 잘 다룰 수 있다.

- 함수형 프로그래머는 부수 효과가 실제로 필요하지만 문제가 될 수 있다는 걸 알기 때문에 부수 효과를 잘 다루기 위한 도구를 많이 알고 있다.
- 마찬가지로 순수하지 않은 함수를 잘 다룰 수 있는 기술도 많이 있다.

### 3. 함수형 프로그래밍은 실용적이다.

```bash
일반적인 함수형 프로그래밍의 정의를 사용하지 않고,
실제 함수형 프로그래밍을 쓰고 있는 프로그래머가 가진 기술과 생각의 흐름, 시각을 정리한다.
```

# 액션과 계산, 데이터

- 많은 함수형 프로그래밍 기술과 개념은 코드를 **`액션`, `계산`, `데이터`로 구분하는 것으로부터 시작**한다.

```jsx
// 사람에 대한 정보
{"firstname": "Eric", "lastname": "Normand"}

// 이메일을 전송하는 함수
* sendEmail(to, from, subject, body)

// 모든 숫자를 더하는 함수
sum(numbers)

// 데이터베이스 저장 함수
* saveUserDB(user)

// 같은 문자열을 넣으면 항상 같은 길이를 반환
string_length(str)

// 호출할 때마다 다른 시간을 반환
* getCurrentTime()

// 숫자 리스트
[1, 10, 2, 45, 3, 98]
```

- `*` 표시가 있는 함수는 호출하는 횟수나 시점에 의존하고 있다. → `액션` 이라 하자
- `액션`은 호출할 때 조심해야 하는 반면, 다른 코드들은 사용하기 쉽다.
    - 예시) sum 함수는 언제 호출해도 항상 같은 값을 반환하기 때문에 호출 시점이 중요하지 않다.
- `계산`과 `데이터`는 부르는 시점이나 횟수가 중요하지는 않지만 실행 여부에서 차이가 있다.
- `데이터`는 정적이고 보이는 그대로의 값을 의미하지만, `계산`은 실행할 수 있지만 실행하기 전까지는 어떻게 동작할지 알 수 없는 것을 의미한다.

```jsx
// 액션
* sendEmail(to, from, subject, body)
* saveUserDB(user)
* getCurrentTime()

// 계산
sum(numbers)
string_length(str)

// 데이터
{"firstname": "Eric", "lastname": "Normand"}
[1, 10, 2, 45, 3, 98]
```

- `액션`, `계산`, `데이터`가 함수형 프로그래밍의 핵심 개념이며, 이런 구분을 바탕으로 만든 기술과 개념이 많다.

```javascript
Tip 💡

1. 호출하는 시점이나 횟수에 의존하는가?
yes : 액션
no : 계산, 데이터

2. 실행이 가능한 코드인가?
yes : 계산
no : 데이터
```

<details>
  <summary>실제 서비스에서 액션, 계산, 데이터를 구분하는 간단한 예시</summary>
  
  - 여러 클라이언트가 작업 완료 표시를 하면 서버에서 이메일을 통해 알려주는 간단한 업무 관리 서비스를 만든다고 가정
    1. 사용자가 작업 완료 표시를 한다.
        - `액션` : 실행 횟수에 의존
    2. 클라이언트가 서버로 메시지를 보낸다.
        - `액션` : 메시지를 보낸다 → 실행 횟수에 의존
        - `데이터` : 메시지
    3. 서버가 메시지를 받는다.
        - `액션` : 실행 횟수에 의존
    4. 서버가 데이터베이스를 변경한다.
        - `액션` : 내부 상태를 바꿈
    5. 서버가 누구에게 알림을 보낼 지 결정한다.
        - `계산` : 입력값이 같다면 항상 같은 사람에게 결정
    6. 서버가 이메일로 알림을 보낸다.
        - `액션` : 같은 메일을 1번 보내는 것과 2번 보내는 것은 다르다 (= 횟수에 의존)
</details>

## 액션

- 실행 시점이나 횟수 또는 둘 다에 의존한다.

→ 시간이 지남에 따라 안전하게 상태를 바꿀 수 있는 방법

→ 순서를 보장하는 방법

→ 액션이 정확히 한 번만 실행되게 보장하는 방법

## 계산

- 같은 입력값을 가지고 계산하면 항상 같은 결과값을 반환한다.
- 외부에 영향을 주지 않아서 언제든지 몇 번을 불러도 안전하다.

→ 정확성을 위한 정적 분석

→ 소프트웨어에서 쓸 수 있는 수학적 지식

→ 테스트 전략

## 데이터

- 이벤트에 대해 기록한 사실이다.
- 알아보기 쉬운 속성으로 되어 있고 실행하지 않아도 데이터 자체로 의미있다.

→ 효율적으로 접근하기 위해 데이터를 구성하는 방법

→ 데이터를 보관하기 위한 기술

→ 데이터를 이용해 중요한 것을 발견하는 원칙

# 요점 정리

- 일반적인 함수형 프로그래밍 정의는 학계 연구자들에게 도움이 되지만 아직까지는 소프트웨어 공학에 많은 도움이 되진 못했다. 그래서 함수형 프로그래밍이 추상적이고 실용적이지 않다는 느낌을 받을 수 있다.
- 함수형 프로그래머는 코드를 액션과 계산, 데이터로 나눠서 바라본다.
- `액션`은 시간에 의존한다. 그래서 사용하기 가장 어렵고, 액션에서 시간에 의존하는 부분을 분리하면 좀 더 다루기 쉬워진다.
- `계산`은 시간에 의존적이지 않다. 다루기 쉽기 때문에 가능한 코드를 계산으로 바꾸는 것이 좋다.
- `데이터`는 정적이고 해석이 필요하다.

---

*2024.01.27 [<<쏙쏙 들어오는 함수형 코딩>>](https://product.kyobobook.co.kr/detail/S000001952246)*
